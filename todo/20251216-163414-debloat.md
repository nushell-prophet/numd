---
status: draft
created: 20251216-163414
updated: 20251216-163414
---
I would like to make the numd module more lean and to adhere closer to unix philosopy.
I've identfied that we can get rid of the flags:

## Flags to remove from `numd run`

### 1. `--save-ansi` ✅ CORRECT
    --save-ansi # save ANSI formatted version

Replace with:
`numd run test.md --echo | save test.ans`

**Analysis**: Logic is sound. `--echo` already outputs ANSI to stdout.

---

### 2. `--no-save` ⚠️ REQUIRES CODE CHANGE
    --no-save # do not save changes to the `.md` file

Replace with:
`numd run save.md --echo`

**Analysis**: Currently `--echo` does NOT block saving (lines 62-65 in commands.nu).
This requires a design change: when `--echo` is used, numd should NOT save to file.
This is the right unix approach (output to stdout OR file, not both).

---

### 3. `--no-backup` ✅ CORRECT
    --no-backup # overwrite the existing `.md` file without backup

Get rid of backup functionality completely. Instead, check that:
- File is tracked by git
- File has no uncommitted changes

If either check fails, warn the user. No backup directory (`zzz_md_backups`) needed.

**Analysis**: Sound approach. Git is the backup system.

---

### 4. `--result-md-path (-o)` ✅ CORRECT
    --result-md-path (-o): path # path to a resulting `.md` file; if omitted, updates the original file

Replace with:
`numd run test.md --echo | ansi strip | save test_diff.md`

**Analysis**: Once `--echo` implies no-save, this is achievable via piping.

---

## Additional debloat opportunities

### 5. `--no-stats` - CONSIDER REMOVING
    --no-stats # do not output stats of changes

**Analysis**: Stats output is problematic - it mixes data types (markdown string vs stats record).
Options:
a) Remove `--no-stats`: Always output stats to **stderr**, markdown to stdout
b) Or: Only output stats when NOT using `--echo` (current behavior is confusing)

Current behavior (lines 69-78): without `--echo` returns record, with `--echo` appends table to string.

---

### 6. `--print-block-results` - CONSIDER REMOVING
    --print-block-results # print blocks one by one as they are executed

**Analysis**: Debugging flag, rarely used (only in commands.nu and README.md).
Could be replaced by `--save-intermed-script` for debugging, or verbose mode via env var.

---

### 7. `--result-md-path` in `clear-outputs` - REMOVE
    --result-md-path (-o): path # in clear-outputs command

Same logic applies:
`numd clear-outputs file.md --echo | save other.md`

---

## Summary of proposed changes

| Flag | Action | Unix Alternative |
|------|--------|------------------|
| `--save-ansi` | Remove | `--echo \| save file.ans` |
| `--no-save` | Remove | `--echo` (must change behavior) |
| `--no-backup` | Remove entirely | Git check instead |
| `--result-md-path` (run) | Remove | `--echo \| ansi strip \| save` |
| `--result-md-path` (clear-outputs) | Remove | `--echo \| save` |
| `--no-stats` | Consider | Stats to stderr |
| `--print-block-results` | Consider | Env var or remove |

**Key behavioral change**: `--echo` must imply "output to stdout only, do not save to file"
